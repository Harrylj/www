<!DOCTYPE html>
<html>

<head lang="en">
	<meta charset="UTF-8">
	<!-- 使用最新的ie内核渲染 -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!-- 移动设备优先, 禁止缩放 -->
	<meta name="viewport"
		content="width=device-width, initial-scale=1,minimum-scale=1,maximum-scale=1, user-scalable=no">
	<!-- 国产浏览器(360)使用webkit内核 -->
	<meta name="renderer" content="webkit">
	<!-- 禁止识别为手机号码 -->
	<meta name="format-detection" content="telephone=no" />
	<meta name="keywords" content="">
	<meta name="description" content="">
	<link rel="stylesheet" type="text/css" href="css/video-js.min.css" />
	<link rel="stylesheet" type="text/css" href="css/custom-theme.css" />
	<link rel="stylesheet" href="css/vant.css" />
	<link rel="stylesheet" type="text/css" href="css/public.css" />
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<title>峰会论坛视频</title>
	<style type="text/css">
		html,body,#app.zhzj,.zhzj-video,.index-video-div{
			height: 100%;
		}
		.zhzj
		,#app {
			padding: 0;
		}
		div.video-js{
			height: 10rem;
		}
		.zhzj-mulu.van-popup--bottom.van-popup--round {
			/* background-color: #162463; */
			background: linear-gradient(90deg, #1116A4, #2480EC);
			border-radius: .67rem .67rem 0 0;
			height: 8rem;
			padding: 0 0 .3rem 0;
		}
		.zhzj-mulu h3,
		.zhzj-mulu-close,
		.zhzj-mulu-item h4,
		.zhzj-mulu-item h5,
		.zhzj-mulu-item h6,
		.zhzj-mulu-item p {
			color: white;
		}

		/* .zhzj-mulu-item h4
		,.zhzj-mulu-item h5{
			text-align: center;
		} */
		.zhzj-mulu-item h4 {
			background-color: #D3D5E9;
			color: #222222;
			width: .55rem;
			height: .55rem;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-left: .3rem;
		}

		.zhzj-mulu-item h5 {
			opacity: .6;
			font-size: .29rem;
			margin-right: .3rem;
		}

		.zhzj-mulu-item h6,
		.zhzj-mulu-item p {
			line-height: .5rem;
		}

		.zhzj-mulu-item h6 {
			font-size: .31rem;
			opacity: .6;
		}

		.zhzj-mulu-item p {
			font-size: .28rem;
			font-weight: bold;
		}

		.zhzj-mulu-title
		,.kms-jianjie {
			display: flex;
			justify-content: space-between;
			align-items: center;
			line-height: 1rem;
			padding: 0 .3rem;
			margin: .2rem 0;
		}
		.kms-jianjie{
			display: inline-block;
		}
		.kms-jianjie h3{
			font-size: .35rem;
		}
		.kms-jianjie p{
			font-size: .29rem;
			line-height: .56rem;
			color: white;
			opacity: .6;
		}
		.zhzj-mulu-item-content {
			width: 3.9rem;
		}

		.zhzj-mulu-title h3 {
			font-size: .35rem;
		}

		.zhzj-mulu-close {
			font-size: .4rem;
			opacity: .8;
		}

		.zhzj-mulu-item {
			display: flex;
			justify-content: space-between;
			/* flex: 10% 70% 20%; */
			flex: 1;
			background-color: #28346F;
			align-items: center;
			min-height: 1.8rem;
			border-radius: .2rem;
			margin-bottom: .2rem;
		}

		.zhzj-mulu-item-hover {
			background-color: #697199;
		}
		.zhzj-video{
			position: relative;
		}
		.index-live,
		.index-video-num {
			top: 1.3rem;
		}
		.public-header-title{
			background-color: rgba(0, 0, 0, .12);
			z-index: 9999;
		}
		.zhzj-btn-jj{
			display: flex;
			justify-content: center;
			align-items: center;
			color: white;
			font-size: .29rem;
		}
		.zhzj-btn-jj .van-icon{
			margin-left: .1rem;
		}
		.kms-btn-close{
			position: fixed;
			right: .1rem;
			bottom: 8.2rem;
			z-index: 2010;
			color: white;
			font-size: .3rem;
			background-image: url(images/quanping.png);
			background-size: .37rem .37rem;
			background-repeat: no-repeat;
			width: 1rem;
			height: 1rem;
			background-position: center center;
		}
		.index-ygz-list{
			display: flex;
			justify-content: space-between;
			width: 6.9rem;
		}
		.index-ygz-list .index-ygz-item img{
			height: 3.5rem!important;
		}
		.jjwb-fhlt{
			border-top: 1px solid rgba(250, 247, 247, 0.15);
		}
		.jjwb-fhlt h2{
			font-size: .35rem;
			line-height: 1rem;
			color: white;
			padding: .1rem 0;
		}
		.index-ygz-item .index-live,
		.index-ygz-item  .index-video-num{
			top: .3rem;
		}
	</style>
</head>

<body>
	<div class="zhzj" id="app" v-cloak>
		<div class="public-header-title">
			<div class="public-header-title-content">
				<div class="phtc-return" @click="public_return_page()"></div>
				<div class="phtc-title"></div>
				<div class="phtc-fenxiang" @click="fenxiang()"></div>
				<!-- <div class="phtc-mulu" @click="mulu()"></div> -->
			</div>
		</div>
		<div class="zhzj-video">
			<div class="index-live"><span></span>{{FHLT.zhibozt}}</div>
			<div class="index-video-num"> <img src="images/index-eye.png" alt=""> {{FHLT.hits}}</div>
			<video-player class="vjs-custom-skin"  :class="!show?'index-video-middle':''" ref="videoPlayer" :options="playerOptions"></video-player>
			<!-- <video-player
				  class="video-player vjs-custom-skin"
				  :class="!show?'index-video-middle':''"
				  ref="videoPlayer"
				  :playsinline="true"
				  :options="playerOptions"
				  @play="onPlayerPlay($event)"
				  @pause="onPlayerPause($event)"
				></video-player> -->
		</div>
		<!-- <div v-show="show" class="kms-btn-close" @click="onPlayerPlay(document.getElementsByClassName('video-player')[0])"></div> -->
		<div v-show="show" class="kms-btn-close" @click="hidePopup()"></div>
		<!-- <van-popup class="zhzj-mulu" :close-on-click-overlay="false" @click-overlay="onPlayerPlay(document.getElementsByClassName('video-player')[0])"  v-model="show" :overlay="true" round position="bottom"> -->
		<van-popup class="zhzj-mulu" :close-on-click-overlay="false" @click-overlay="hidePopup()" v-model="show" :overlay="true" round position="bottom">
			<div class="zhzj-mulu-title" v-show="!showJJ">
				<h3>{{FHLT.title}}</h3>
				<div class="zhzj-btn-jj" @click="jianjie()">简介<van-icon name="arrow" /></div>
			</div>
			
			<div class="jjwb-fhlt index-ygz" v-show="!showJJ">
					<h2>其他视频</h2>
					<div class="jjwb-fhlt-div">
						<div class="index-ygz-list">
							<div class="index-ygz-item" @click="goPage('column_fhlt_video.html',{'id':item.id})"  v-for="(item,index) in listFHLT" :key="index">
								<div class="index-live"><span></span>{{item.zT}}</div>
								<!-- <img :src="item.imageUrl" alt=""> -->
								<van-image
										fit="cover"
										:src="item.imageUrl"
								><template v-slot:error>加载失败</template></van-image>
								<h3 class="van-ellipsis">{{item.title}}</h3>
								<p class="van-ellipsis">{{item.createdDate?item.createdDate.split(' ')[0]:''}}</p>
							</div>
						</div>
					</div>
				</div>
			<div class="kms-jianjie" v-show="showJJ">
				<h3>简介</h3>
				<p>
					{{FHLT.summary}}
				</p>
			</div>

		</van-popup>
		<!-- 分享内容start -->
		<link rel="stylesheet" href="css/share.min.css">
		<div class="weixin-share" v-if="showShareWX" @click="showShareWX=false"></div>
		<van-popup class="public-fenxiang-popup" v-model="showShare" position="bottom"  >
			<div class="public-fenxiang-popup-div" >
				<div id="share-2" v-show="showShare" v-show="showShare"></div>
				<div class="public-fenxiang-popup-close" @click="showShare=false">取消</div>
			</div>
		</van-popup>
		<script src="js/social-share.js"></script>
		<script src="js/qrcode.js"></script>
		<!-- 分享内容over -->
	</div>
	<script>

	</script>
	<script src="js/jquery-2.1.3.min.js"></script>
	<script src="js/public.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/axios.min.js"></script>
	<script src="js/axios_my.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/vant.min.js"></script>
	<script src="js/vue-video-player.min.js"></script>
	<script src="js/videojs-contrib-hls.min.js"></script>
	<script type="text/javascript">
		var _obj = public_obj();
		 
		// 挂载VueVideoPlayer插件
		Vue.use(VueVideoPlayer)
		var app = new Vue({
			el: '#app',
			data: {
				showShare:false,  // 分享
				showShareWX:false,	// 微信浏览器分享
				value: 2,
				active: 3,
				message: '展会直击',
				showJJ:false,
				show: false,
				playerOptions: {
					autoplay: false,
					controls: true,
					poster: "images/bg.png", //你的封面地址
					notSupportedMessage: '此视频暂无法播放，请稍后再试', //允许覆盖Video.js无法播放媒体源时显示的默认信息。
					sources: [
						{
							withCredentials: false,
							// type: 'application/x-mpegURL',
							// src: 'https://api.dc.sdtzcd.com/video/1/playlist.m3u8',
							src:'',
							muted: false,
							nativeAudioTracks:false,
						}
					]
				},
				videoDialogVisible: false, // 控制弹出层
				contentID:0, // 内容id
				FHLT:'', // 峰会论坛内容
				listFHLT:[], // 峰会论坛其他视频
				shareId:'', // 分享id
			},
			created: function () {
				var _this = this;
				this.contentID = qs2obj(window.location.href).id;
				// console.log(1)
				// vant.Toast('提示看看');
				//视频播放量
				// axios.get('api/hits/'+_obj.idSite+'/'+ _obj.idFHLT +'/'+ this.contentID)
				// .then(function (response) {
				// 	console.log(response);
				// })
				// .catch(function (error) {
				// 	console.log(error);
				// });
				// 获取峰会论坛内容
				axios.get('api/v1/contents/'+_obj.idSite+'/'+ _obj.idFHLT +'/'+this.contentID)
				.then(function (response) {
					_this.FHLT = response.data;
					public_imgsrc([_this.FHLT])
					_this.playerOptions.poster = _this.FHLT.imageUrl;
					// _this.playerOptions.sources[0].src = _this.FHLT.shipin;
					// console.log('123',_this.KMS);
					// 直播
					if( _this.videoML[0].zT == 'LIVE' || _this.videoML[0].zt == 'LIVE'){
						_this.playerOptions.sources[0].type ='application/x-mpegURL';
						_this.playerOptions.sources[0].src =  _this.FHLT.shipin;
						console.log('直播')
					}
					// 回放
					else{
						console.log('回放')
						_this.playerOptions.sources[0].src =  _this.FHLT.videoUrl
					}
					_this.shareId = _this.FHLT.id;

				})
				.catch(function (error) {
					console.log(error);
				});
				// 获取峰会论坛其他视频
				axios.post('api/v1/contents', {
					"siteId": _obj.idSite,
					"channelId": _obj.idFHLT,
					"wheres":[ {
						"column": "checked",
						"operator": "=",
						"value": "1"
					}],
					"page": 1,
					"perPage": 200
				})
				.then(function (response) {
					var arrContent = response.data.contents;
					public_imgsrc(arrContent)
					// 随机数组取2值
					_this.listFHLT = getRandomArrayElements(arrContent, 2)
					console.log('123',_this.listFHLT);
				})
			},
			mounted: function () {
				// this.mulu()
			},
			methods: {
				//分享
				fenxiang() {
					var _this = this;
					// 统计分享量
					axios.post(_obj.shopUrl+'api/services/app/SiteServer/IncrementSharding', {
						"siteId": _obj.idSite,
						"channelId": _obj.idFHLT,
						"contentId": qs2obj(window.location.href).id,
					})
					.then(function (response) {
					})
					if(isWeChatBrowser()){
						this.showShareWX = true;
					}
					else{
						this.showShare = true;
						setTimeout(()=>{
							_this.fenxiangNext();
						},50)
					}
				},
				// 分享组件
				fenxiangNext(){
					socialShare('#share-2', {sites: ['wechat','weibo']});
				},
				// 视频全屏事件1
				full(element) {	
					//做兼容处理
					if (element.requestFullscreen) {
						element.requestFullscreen();
					} else if (element.mozRequestFullScreen) {
						element.mozRequestFullScreen();
					} else if (element.msRequestFullscreen) {
						element.msRequestFullscreen();
					} else if (element.oRequestFullscreen) {
						element.oRequestFullscreen();
					} else if (element.webkitRequestFullscreen) {
						element.webkitRequestFullScreen();
					} else {
						var docHtml = document.documentElement;
						var docBody = document.body;
						var videobox = document.getElementsByClassName("video-player");
						var cssText = "width:100%;height:100%;overflow:hidden;";
						docHtml.style.cssText = cssText;
						docBody.style.cssText = cssText;
						videobox.style.cssText = cssText + ";" + "margin:0px;padding:0px;";
						document.IsFullScreen = true;
					}
				},
				// onPlayerPlay(document.getElementsByClassName('video-player')[0])
				// 视频全屏触发事件
				onPlayerPlay(player) {
					this.full(player)
				},
				showPopup() {
					this.show = true;
					this.showJJ = false; 
				},
				hidePopup() {
					this.show = false;
				},
				mulu() {
					this.showPopup()
				},
				jianjie(){
					this.showJJ = true; 
				},
				onClickLeft() {
					vant.Toast('返回');
				},
				onClickRight() {
					vant.Toast('按钮');
				},
				selectMulu(_index) {
					this.active = _index;
					vant.Toast(this.active)
					this.hidePopup()
				}
			},

		})
	</script>
</body>

</html>